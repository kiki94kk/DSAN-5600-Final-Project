---
title: "Data Visualization"
author: "Ke Tian"
format: 
      html:
        code-fold: true
        echo: true
        message: false
        warning: false
---

# Instruction

On this website, we will explore the natural gas data from the data source page

## Natural Gas Prices

This is the 2019-2024 data visualization of U.S. natural gas prices over time data visualization, it shows fluctuations in different categories of prices, including Citygate Price, Electric Power Price, LNG Import Price, and Residential Price.

Looking at this graph we can see a seasonal trend, with residential prices for NATURAL GAS showing a price peak in the winter months of the year, which may be related to increased demand for heating. The main price fluctuation occurs in early 2021 and late 2021 when LNG prices spike, which may be due to an extreme weather event, possibly due to the winter blizzard in Texas in 2021 that triggered an increase in heating demand, which triggered the price spike. The price of LNG also shows a sharp increase from mid-2022 to mid-2023, which could be due to a shortage of LNG caused by the Russia-Ukraine conflict.

In the mid-2020s, all natural gas prices trend downward, likely due to the economic downturn caused by the covid-19 outbreak during this period, which reduced industrial and commercial energy demand.

From 2019 to 2024 citygate prices and electricity prices are relatively flat with little volatility.

```{r}
library(quantmod)
library(plotly)
library(xts)

getSymbols("NG=F", src = "yahoo", from = "2010-01-01")
natgas <- Cl(`NG=F`)
natgas_df <- data.frame(date = index(natgas),price = coredata(natgas))

colnames(natgas_df) <- c("date", "price")

fig <- plot_ly(
  data = natgas_df,
  x = ~date,
  y = ~price,
  type = 'scatter',
  mode = 'lines',
  line = list(width = 1.5),
  hoverinfo = "x+y",
  name = "Natural Gas Price"
) %>%
  layout(
    title = "Henry Hub Natural Gas Futures Price (NG=F)",
    xaxis = list(title = "Date"),
    yaxis = list(title = "Price (USD)"),
    hovermode = "closest"
  )

fig
```

## Natural Gas Consumption

This chart shows the trends in natural gas consumption in the United States for different sectors from 2000-2025. Overall, natural gas consumption has been on an upward trend for more than two decades, particularly in the power sector (red), where consumption has risen sharply, reflecting the growing importance of natural gas in power generation.

Natural gas use in the industrial sector (green) has also been increasing gradually, but at a more steady rate. In contrast, natural gas consumption in the Pipeline & Distribution (blue) sector is relatively low and less volatile, and is primarily used for transportation and system maintenance. Residential gas consumption (purple) shows strong seasonal fluctuations, with consumption rising sharply each winter and falling back in the summer. This trend is closely related to heating demand, suggesting that weather has a strong influence on gas consumption. In addition, there may be some unusual fluctuations in the consumption data, which may be influenced by specific economic events or changes in energy policy

This figure shows trends in natural gas consumption in the United States by sector from 2000-2025. Overall, natural gas consumption has been trending upward for more than two decades, particularly in the electric power sector (red), where consumption has risen sharply, reflecting the growing importance of natural gas in power generation.

Natural gas use in the industrial sector (green) has also been gradually increasing, but at a more steady rate. In contrast, natural gas consumption in the Pipeline & Distribution (blue) sector is relatively low and less volatile, and is primarily used for transportation and system maintenance. Residential natural gas consumption (purple) shows strong seasonal fluctuations, with consumption rising sharply in the winter and falling back in the summer each year. This trend is closely related to heating demand, suggesting that weather has a strong influence on natural gas consumption. In addition, there may be some anomalous fluctuations in consumption data due to specific economic events or changes in energy policy

The Covid-19 outbreak in early 2020 and the massive embargo measures worldwide led to a sudden drop in economic activity. Many factories, stores, schools and offices closed, and demand for commercial and industrial gas fell. At the same time, residential gas use (purple) may increase during this period as people stay in their homes for longer periods of time, especially for everyday uses such as heating.

```{r}
library(readr)
library(ggplot2)
library(lubridate)
library(tidyr)
library(dplyr)

df <- read_csv("Natural_Gas_Summary.csv", skip = 6)

colnames(df)[1] <- "Date"

df$Date <- parse_date_time(df$Date, orders = "b-y")

consumption_columns <- c(
  "U.S. Natural Gas Residential Consumption (MMcf) MMcf",
  "U.S. Natural Gas Industrial Consumption (MMcf) MMcf",
  "U.S. Natural Gas Pipeline & Distribution Use (MMcf) MMcf",
  "U.S. Natural Gas Deliveries to Electric Power Consumers (MMcf) MMcf"
)

df_long <- df %>%
  select(Date, all_of(consumption_columns)) %>%
  pivot_longer(cols = -Date, names_to = "Sector", values_to = "Consumption")

df_long$Sector <- gsub(" \\(MMcf\\) MMcf", "", df_long$Sector)
df_long$Sector <- gsub("U\\.S\\. Natural Gas ", "", df_long$Sector)

df_long <- df_long %>%
  mutate(Sector = recode(Sector,
                         "Residential Consumption" = "Residential",
                         "Industrial Consumption" = "Industrial",
                         "Pipeline & Distribution Use" = "Pipeline/Distribution",
                         "Deliveries to Electric Power Consumers" = "Electric Power"))

df_long <- df_long %>%
  filter(year(Date) >= 2000 & year(Date) <= 2025)

ggplot(df_long, aes(x = Date, y = Consumption, color = Sector)) +
  geom_line(size = 1) +
  labs(title = "Natural Gas Consumption Trends by Sector (2000-2025)",
       x = "Date",
       y = "Consumption (MMcf)",
       color = "Sector") +
  theme_minimal()


```

## Natural Gas Exports by Conutries

This plot shows trends in U.S. natural gas exports to different countries (2000-2025), broken down by mode of transportation (LNG shipments and pipeline shipments). Looking at the data, U.S. natural gas exports have grown rapidly since around 2010, with liquefied natural gas (LNG) exports in particular becoming dominant in recent years, far outpacing pipeline deliveries.

Canada and Mexico are the main natural gas pipeline exporters to the U.S. Because these two countries are adjacent to the U.S., pipeline transportation is relatively easy and the U.S. is a major producer of natural gas, and from 2010, demand for natural gas from Mexico has increased dramatically. The demand of other countries is relatively small. However, from around 2022, the demand for natural gas increases in some of the major exporting countries, and these are due to the outbreak of the Russian-Ukrainian war, which has resulted in these countries not being able to import natural gas from Russia, and having to look to the United States for natural gas resources.

```{r}
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyr)
df <- read_csv("U.S._Natural_Gas_Exports_Country.csv", skip = 6)

df_long <- df %>%
  pivot_longer(cols = -Year, names_to = "Country", values_to = "Export_Volume")

df_long$Country <- gsub(" \\$/Mcf| MMcf", "", df_long$Country)

df_long$Country <- gsub(".*((?:Vessels?|Exports) to [[:alpha:][:space:]]+).*", "\\1", df_long$Country)

df_long$Country <- gsub("Vessels to", "Vessel to", df_long$Country)

df_long <- df_long %>%
  filter(Year >= 2000 & Year <= 2025 & !is.na(Export_Volume) & Export_Volume > 0)

ggplot(df_long, aes(x = Year, y = Export_Volume, color = Country, group = Country)) +
  geom_line(size = 1) +
  scale_x_continuous(
    breaks = seq(2000, 2025, 5), 
    limits = c(2000, 2025),
    expand = c(0, 0)            
  ) +
  labs(title = "U.S. Natural Gas Exports by Country Over Time",
       x = "Year",
       y = "Export Volume (MMcf)",
       color = "Country") +
  theme_minimal() +
  theme(aspect.ratio = 1/3)  
```

## Natural Gas Storage

Here is the Natural Gas Storage data visualization

```{r}
df_storage <- read.csv("Natural_Gas_Summary.csv", skip = 6)
colnames(df_storage)[1] <- "Date"
df_storage$Date <- parse_date_time(df_storage$Date, orders = "b-y")

df_storage <- df_storage %>%
  select(Date, Base_Storage = `U.S..Total.Natural.Gas.in.Underground.Storage..Base.Gas...MMcf..MMcf`) %>%
  filter(year(Date) >= 2015 & year(Date) <= 2025) %>%
  filter(!is.na(Base_Storage))

ggplot(df_storage, aes(x = Date, y = Base_Storage)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(
    title = "U.S. Total Natural Gas in Underground Storage (Base Gas)",
    x = "Date",
    y = "Storage (MMcf)"
  ) +
  theme_minimal()
```

The U.S. underground storage plot (2015–2025) exhibits a pronounced annual injection–withdrawal cycle: storage levels climb steadily each spring through early fall as excess supply is injected, reaching peak volumes around October, then decline sharply over the winter withdrawal season to trough values by March. Moreover, peak storage levels have inched higher over the decade—suggesting modest growth in total working capacity—while winter lows remain relatively stable, underscoring the system’s resilience in meeting heating‐season demand

## Yohoo WTI Visualization

```{r}
library(tidyquant)
library(ggplot2)
library(lubridate)

oil_prices <- tq_get("CL=F",
                     from = "2010-01-01",
                     to = Sys.Date())

head(oil_prices)

ggplot(oil_prices, aes(x = date, y = adjusted)) +
  geom_line(color = "steelblue", size = 1) +
  labs(title = "WTI Crude Oil Prices (Yahoo Finance)",
       x = "Date",
       y = "Adjusted Price (USD/barrel)") +
  theme_minimal()
```

WTI prices (2010–present) display multiple boom–bust cycles tied to global events. After rising from roughly \$70 to over \$100 /barrel by mid-2014, prices plunged through 2015–2016 to the \$30–40 range amid supply gluts. They then recovered to \$60–70 before the COVID-19 shock drove a brief collapse below \$20 in early 2020. In response to the Russia–Ukraine conflict, prices spiked above \$120 in mid-2022 and have since retraced toward a \$70–90 band, reflecting a new equilibrium between demand recovery and expanded U.S. production