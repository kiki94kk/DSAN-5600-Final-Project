decomposed <- decompose(ts_residential, type = "multiplicative")
plot(decomposed)
ts_residential <- na.omit(ts_residential)
par(mfrow = c(1, 2))
acf(ts_residential, main = "ACF - Residential Price")
pacf(ts_residential, main = "PACF - Residential Price")
par(mfrow = c(1, 1))
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(TTR)
library(forecast)
library(ggpubr)
library(tseries)
library(zoo)
df <- read.csv("Natural_Gas_Summary.csv", skip = 6)
df <- df %>% filter(!is.na(Month))
df$Year <- as.numeric(sub(".* ([0-9]{4})$", "\\1", df$Month))
df_filtered <- df %>% filter(Year >= 2019)
df_filtered$Month_Num <- match(substr(df_filtered$Month, 1, 3), month.abb)
df_filtered <- df_filtered %>% arrange(Year, Month_Num)
df_filtered <- df_filtered %>%
complete(Year, Month_Num, fill = list(Residential_Price = NA, LNG_Import_Price = NA,
Citygate_Price = NA, Electric_Power_Price = NA))
price_cols <- c("Month",
"U.S..Price.of.Natural.Gas.Delivered.to.Residential.Consumers....Mcf....Mcf",
"Price.of.U.S..Natural.Gas.LNG.Imports....Mcf....Mcf",
"U.S..Natural.Gas.Citygate.Price....Mcf....Mcf",
"U.S..Natural.Gas.Electric.Power.Price....Mcf....Mcf")
df_prices <- df_filtered[, price_cols]
colnames(df_prices) <- c("Month", "Residential Price ($/Mcf)",
"LNG Import Price ($/Mcf)",
"Citygate Price ($/Mcf)",
"Electric Power Price ($/Mcf)")
df_prices$Month <- factor(df_prices$Month, levels = unique(df_filtered$Month), ordered = TRUE)
df_prices_clean <- df_prices %>%
mutate(Year = df_filtered$Year[match(df_prices$Month, df_filtered$Month)],
Month_Num = df_filtered$Month_Num[match(df_prices$Month, df_filtered$Month)])
df_long <- df_prices %>% pivot_longer(cols = -Month, names_to = "Category", values_to = "Price")
df_prices$Month <- factor(df_prices$Month, levels = unique(df_filtered$Month), ordered = TRUE)
df_long <- df_prices %>% pivot_longer(cols = -Month, names_to = "Category", values_to = "Price")
ggplot(df_long, aes(x = Month, y = Price, color = Category, group = Category)) +
geom_line(size = 1) +
labs(title = "Natural Gas Prices Over Time (2019-Present)",
x = "Time",
y = "Price ($/Mcf)",
color = "Category") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(df_long, aes(x = Month, y = Price, color = Category, group = Category)) +
geom_line(size = 1) +
labs(title = "Natural Gas Prices Over Time (2019-Present)",
x = "Time",
y = "Price ($/Mcf)",
color = "Category") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
par(mfrow = c(3, 2))
for (lag in 1:6) {
plot(df_prices$`Residential Price ($/Mcf)`[-(1:lag)],
df_prices$`Residential Price ($/Mcf)`[(lag+1):nrow(df_prices)],
main = paste("Lag", lag), xlab = "Previous Price", ylab = "Current Price")
}
par(mfrow = c(1, 1))
ts_residential <- ts(df_prices$`Residential Price ($/Mcf)`, start = c(2019, 1), frequency = 12)
decomposed <- decompose(ts_residential, type = "multiplicative")
plot(decomposed)
ts_residential <- ts(df_prices$`Residential Price ($/Mcf)`, start = c(2019, 1), frequency = 12)
decomposed <- decompose(ts_residential, type = "multiplicative")
plot(decomposed)
ts_residential <- na.omit(ts_residential)
par(mfrow = c(1, 2))
acf(ts_residential, main = "ACF - Residential Price")
pacf(ts_residential, main = "PACF - Residential Price")
par(mfrow = c(1, 1))
adf.test(ts_residential)
df_prices_clean <- df_prices_clean %>%
mutate(
MA_3 = zoo::rollmean(`Residential Price ($/Mcf)`, k = 3, fill = NA, align = "right"),
MA_6 = zoo::rollmean(`Residential Price ($/Mcf)`, k = 6, fill = NA, align = "right"),
MA_12 = zoo::rollmean(`Residential Price ($/Mcf)`, k = 12, fill = NA, align = "right")
)
df_ma_long <- df_prices_clean %>%
select(Year, Month_Num, `Residential Price ($/Mcf)`, MA_3, MA_6, MA_12) %>%
pivot_longer(cols = c(`Residential Price ($/Mcf)`, MA_3, MA_6, MA_12),
names_to = "Category", values_to = "Price")
ggplot(df_ma_long, aes(x = as.Date(paste(Year, Month_Num, "1", sep = "-")),
y = Price, color = Category, linetype = Category)) +
geom_line(size = 1) +
labs(title = "Residential Natural Gas Price with Moving Average Smoothing",
x = "Time", y = "Price ($/Mcf)", color = "Legend", linetype = "Legend") +
scale_x_date(date_labels = "%Y-%m", date_breaks = "6 months") +
theme_minimal()
print(ts_residential)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
cv_errors_1 <- tsCV(
ts_residential,
function(y, h) as.numeric(forecast(Arima(y, model = best_manual_model), h = h)$mean),
h = 1,
initial = 30
)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
cv_errors_1 <- tsCV(
ts_residential,
function(y, h) as.numeric(forecast(Arima(y, model = best_manual_model), h = h)), # 直接使用 fc，而不是 fc$mean
h = 1,
initial = 30
)
print(cv_errors_1)
rmse_1 <- sqrt(mean(cv_errors_1^2, na.rm = TRUE))
print(paste("1-step ahead CV RMSE:", rmse_1))
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_fit <- Arima(ts_residential, model = best_manual_model)
print(test_fit)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_fit <- Arima(ts_residential, model = best_manual_model)
print(test_fit)
test_forecast <- forecast(Arima(ts_residential, model = best_manual_model), h = 1)
print(test_forecast)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_fit <- Arima(ts_residential, model = best_manual_model)
print(test_fit)
test_forecast <- forecast(test_fit, h = 1)
print(test_forecast)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_fit <- Arima(ts_residential, model = best_manual_model)
print(test_fit)
test_forecast <- forecast(test_fit, h = 1)
print(test_forecast)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_fit <- Arima(ts_residential, model = best_manual_model)
print(test_fit)
test_forecast <- forecast(test_fit, h = 1)
print(test_forecast)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
fc_1 <- forecast(fitted_model, h = 1)
print(fc_1)
preds_1 <- as.numeric(fc_1$mean)
preds_1[is.na(preds_1)] <- 0
print(preds_1)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
fitted_model <- Arima(ts_residential, model = best_manual_model)
cv_errors_1 <- tsCV(
ts_residential,
test_cv,
h = 1,
initial = 10  # 先减少 initial 的值
)
fitted_model <- Arima(ts_residential, model = best_manual_model)
cv_errors_1 <- tsCV(
ts_residential,
test_cv,
h = 1,
initial = 10  # 先减少 initial 的值
)
fitted_model <- Arima(ts_residential, model = best_manual_model)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
cv_errors_1 <- tsCV(
ts_residential,
test_cv,
h = 1,
initial = 10  # 先减少 initial 的值
)
fitted_model <- Arima(ts_residential, model = best_manual_model)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
return(as.numeric(fc$mean))  # 返回预测值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
cv_errors_1 <- tsCV(
ts_residential,
test_cv,
h = 1,
initial = 10  # 先减少 initial 的值
)
fitted_model <- Arima(ts_residential, model = best_manual_model)
test_cv <- function(y, h) {
fit <- Arima(y, model = best_manual_model)  # 重新拟合 ARIMA
fc <- forecast(fit, h = h)  # 预测
print(fc)  # 打印 fc 检查结构
# 检查 forecast 结果是否是数据框或时间序列对象
if (is.data.frame(fc)) {
preds <- as.numeric(fc[["Point Forecast"]])  # 直接从数据框提取
} else if (is.list(fc) && !is.null(fc$mean)) {
preds <- as.numeric(fc$mean)  # 如果是 list，则提取 mean
} else {
stop("Unexpected structure in forecast output")  # 报错
}
return(preds)  # 返回数值
}
# 用 ts_residential 作为输入，预测 1 期
test_cv(ts_residential, 1)
cv_errors_1 <- tsCV(
ts_residential,
test_cv,
h = 1,
initial = 10  # 先减少 initial 的值
)
fitted_model <- Arima(ts_residential, order = c(0,1,0),
seasonal = c(0,1,1), period = 12)
fitted_model <- Sarima(ts_residential, order = c(0,1,0),
seasonal = c(0,1,1), period = 12)
fitted_model <- Arima(ts_residential, order = c(0,1,0),
seasonal = c(0,1,1), period = 12)
# 加载 forecast 包
library(forecast)
# 拟合最佳SARIMA模型
fitted_model <- Arima(ts_residential, order = c(0,1,0),
seasonal = list(order = c(0,1,1), period = 12))
# 进行 36 个月的预测
forecast_12 <- forecast(fitted_model, h = 36)
# 打印预测结果
print(forecast_12)
# 可视化预测
autoplot(forecast_12) +
ggtitle("SARIMA(0,1,0) × (0,1,1)_12 预测") +
xlab("时间") +
ylab("住宅价格 ($/Mcf)")
fitted_model <- Arima(ts_residential, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
forecast_12 <- forecast(fitted_model, h = 36)
print(forecast_12)
# 可视化预测
autoplot(forecast_12) +
ggtitle("SARIMA(0,1,0) × (0,1,1)[12] Forcast") +
xlab("Time") +
ylab("Residential Price ($/Mcf)")
library(ggplot2)
library(forecast)
ts_us_gas <- ts(us_gas$Production, start = min(us_gas$Year), frequency = 1)
forecast_horizon <- 10
best_model <- Arima(ts_us_gas, order = c(2,2,1))
arima_forecast <- forecast(best_model, h = forecast_horizon)
autoplot(arima_forecast) +
labs(title = "Forecast using ARIMA(2,2,1)",
x = "Year", y = "Predicted Values")
fitted_model <- Arima(ts_residential, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
forecast_12 <- forecast(fitted_model, h = 36)
print(forecast_12)
autoplot(forecast_12) +
ggtitle("SARIMA(0,1,0) × (0,1,1)[12] Forcast") +
xlab("Time") +
ylab("Residential Price ($/Mcf)")
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
print(length(train_set))
print(length(test_set))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_12 <- forecast(fitted_model, h = length(test_set))
print(forecast_12)
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_12 <- forecast(fitted_model, h = length(test_set))
print(forecast_12)
autoplot(forecast_12) +
autolayer(test_set, series = "真实值", color = "red") +
ggtitle("SARIMA 预测 vs 真实值") +
xlab("时间") + ylab("值") +
theme_minimal()
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_12 <- forecast(fitted_model, h = length(test_set))
print(forecast_12)
autoplot(forecast_12) +
autolayer(test_set, series = "真实值", color = "red") +
ggtitle("SARIMA 预测 vs 真实值") +
xlab("时间") + ylab("值") +
theme_minimal()
rmse <- sqrt(mean((forecast_12$mean - test_set)^2, na.rm = TRUE))
print(paste("RMSE:", rmse))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_1 <- forecast(fitted_model, h = length(test_set))
rmse_1 <- sqrt(mean((forecast_1$mean - test_set)^2, na.rm = TRUE))
print(paste("1-step ahead RMSE:", rmse_1))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_1 <- forecast(fitted_model, h = length(test_set))
rmse_1 <- sqrt(mean((forecast_1$mean - test_set)^2, na.rm = TRUE))
print(paste("1-step ahead RMSE:", rmse_1))
forecast_12 <- forecast(fitted_model, h = 12)
rmse_12 <- sqrt(mean((forecast_12$mean[1:length(test_set_12)] - test_set_12)^2, na.rm = TRUE))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_1 <- forecast(fitted_model, h = length(test_set))
rmse_1 <- sqrt(mean((forecast_1$mean - test_set)^2, na.rm = TRUE))
print(paste("1-step ahead RMSE:", rmse_1))
forecast_12 <- forecast(fitted_model, h = length(test_set))
rmse_12 <- sqrt(mean((forecast_12$mean[1:length(test_set_12)] - test_set_12)^2, na.rm = TRUE))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_1 <- forecast(fitted_model, h = length(test_set))
rmse_1 <- sqrt(mean((forecast_1$mean - test_set)^2, na.rm = TRUE))
print(paste("1-step ahead RMSE:", rmse_1))
forecast_12 <- forecast(fitted_model, h = 12)
test_set_12 <- test_set[1:12]
rmse_12 <- sqrt(mean((forecast_12$mean[1:length(test_set_12)] - test_set_12)^2, na.rm = TRUE))
print(paste("12-step ahead RMSE:", rmse_12))
train_size <- round(0.8 * length(ts_residential))
train_set <- window(ts_residential, end = time(ts_residential)[train_size])
test_set  <- window(ts_residential, start = time(ts_residential)[train_size + 1])
print(length(train_set))
print(length(test_set))
fitted_model <- Arima(train_set, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
summary(fitted_model)
forecast_1 <- forecast(fitted_model, h = length(test_set))
rmse_1 <- sqrt(mean((forecast_1$mean - test_set)^2, na.rm = TRUE))
print(paste("1-step ahead RMSE:", rmse_1))
forecast_12 <- forecast(fitted_model, h = 12)
test_set_12 <- test_set[1:12]
rmse_12 <- sqrt(mean((forecast_12$mean[1:length(test_set_12)] - test_set_12)^2, na.rm = TRUE))
print(paste("12-step ahead RMSE:", rmse_12))
fitted_model <- Arima(ts_residential, order = c(0,1,0), seasonal = list(order = c(0,1,1), period = 12))
forecast_36 <- forecast(fitted_model, h = 36)
autoplot(forecast_36) +
ggtitle("SARIMA(0,1,0) × (0,1,1)[12] Forcast") +
xlab("Time") +
ylab("Residential Price ($/Mcf)")
df_gas <- read.csv("Natural_Gas_Summary.csv", skip = 6)
df_clean <- df_gas[, c("Month",
"U.S..Natural.Gas.Citygate.Price....Mcf....Mcf",
"U.S..Total.Natural.Gas.in.Underground.Storage..Working.Gas...MMcf..MMcf",
"U.S..Natural.Gas.Total.Consumption..MMcf..MMcf")]
colnames(df_clean) <- c("Date", "GasPrice", "Storage", "Consumption")
write.csv(df_clean, file = "cleaned_natural_gas_data.csv", row.names = FALSE)
library(dplyr)
library(lubridate)
df_gas <- read.csv("cleaned_natural_gas_data.csv")
colnames(df_gas)[1] <- "Month"
df_gas$Month <- parse_date_time(df_gas$Month, orders = "b-y")
df_gas$YearMonth <- format(df_gas$Month, "%Y-%m")
df_oil <- read.csv("Cushing_OK_WTI_Spot_Price_FOB.csv")
colnames(df_oil) <- c("Date", "OilPrice")
df_oil$Date <- as.Date(df_oil$Date, format = "%m/%d/%Y")
df_oil$YearMonth <- format(df_oil$Date, "%Y-%m")
df_oil_monthly <- df_oil %>%
group_by(YearMonth) %>%
summarise(OilPrice = mean(OilPrice, na.rm = TRUE))
df_gas_final <- df_gas[, c("YearMonth", "GasPrice", "Storage", "Consumption")]
df_oil_monthly_filtered <- df_oil_monthly %>%
filter(YearMonth %in% df_gas$YearMonth)
df_gas_final$YearMonth <- as.character(df_gas_final$YearMonth)
df_oil_monthly_filtered$YearMonth <- as.character(df_oil_monthly_filtered$YearMonth)
df_merged <- merge(df_gas_final, df_oil_monthly_filtered, by = "YearMonth", all = FALSE)
write.csv(df_merged, file = "merge_gas_oil.csv", row.names = FALSE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)
df_merged$YearMonth <- ym(df_merged$YearMonth)
df_long <- df_merged %>%
pivot_longer(cols = c(GasPrice, OilPrice, Storage, Consumption),
names_to = "Variable", values_to = "Value")
ggplot(df_long, aes(x = YearMonth, y = Value, color = Variable)) +
geom_line(na.rm = TRUE) +
facet_wrap(~Variable, scales = "free_y", ncol = 1) +
labs(title = "Time Series of GasPrice, OilPrice, Storage, and Consumption",
x = "Date", y = "Value") +
theme_minimal()
library(forecast)
df_model <- na.omit(df_merged)
y <- ts(df_model$GasPrice, frequency = 12)
xreg_simple <- as.matrix(df_model[, c("OilPrice", "Storage")])
model_auto <- auto.arima(y, xreg = xreg_simple)
summary(model_auto)
df_gas <- read.csv("Natural_Gas_Summary.csv", skip = 6)
df_clean <- df_gas[, c("Month",
"U.S..Natural.Gas.Citygate.Price....Mcf....Mcf",
"U.S..Total.Natural.Gas.in.Underground.Storage..Working.Gas...MMcf..MMcf",
"U.S..Natural.Gas.Total.Consumption..MMcf..MMcf")]
colnames(df_clean) <- c("Date", "GasPrice", "Storage", "Consumption")
write.csv(df_clean, file = "cleaned_natural_gas_data.csv", row.names = FALSE)
interactive_plot
# 加载必要的包
library(readr)
library(dplyr)
library(ggplot2)
library(plotly)
# 1. 读取数据（请确保 CSV 文件路径正确）
health_df <- read_csv("PLACES__Local_Data_for_Better_Health__County_Data_2024_release_20250330.csv")
